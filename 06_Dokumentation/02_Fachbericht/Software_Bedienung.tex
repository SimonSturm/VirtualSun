\subsection{Bedienung}
Die Bedienungssoftware ist anwenderfreundlich aufgebaut, indem der Benutzer in zwei Schritten die Bestrahlungsstärke und den Modus wählt. Zeitgleich gibt die Software die Einstellungen des Benutzers und die berechneten Spannungs- und Stromwerte auf dem Bildschirm aus.

Das LCD zeigt die Werte in der Reihenfolge Spannung, Strom, Bestrahlungsstärke und Modus an. Für Strom und Spannung liest der Analog-Digital-Wandler (ADC) die Werte wiederholend aus und berechnet diese intern. Die Taster dienen dazu, die Bestrahlungsstärke zu erhöhen, zu reduzieren und den Modus umzuschalten. Mit der nachfolgenden Beschreibung der Software wird das Prinzip des Entprellens, des automatischen Zählens in Zehnerschritten und die Funktionsweise der Modustaste beschrieben.

\subsubsection{Tasterentprellung}
Die Entprellung reduziert sich sich auf wenig Zeilen Code und den Zeit-Unterbrecher (Timer-Interrupt), der alle 16ms die Funktion \textit{check\_button()} aufruft, die Tasten prüft und die Variablen berechnet, die auf dem LCD ausgegeben werden. Das parallele verarbeiten aller Tasten in einer einzigen Variable macht die Entprellung einfacher und den Code schlanker. Stellvertretend für alle Taster steht die Variable \textit{button}. Die Taster sind alle auf dem gleichen Eingang (\textit{PORTD}) angeschlossen und werden beim Aufrufen der Funktion \textit{check\_button()} in die Variable \textit{current\_button} invertiert eingelesen. Ein Taster wird als gedrückt erkannt, wenn der Taster (\textit{button}) gleich dem alten invertierten Tasterzustand (\textit{old\_button}), dem momentanen Tasterzustand (\textit{current\_button}) und der Pinmaske (\textit{BUTTONMASK}) ist. Der alte Tasterzustand wird zum Ende der Funktion gleich dem momentanen Tasterzustand gesetzt. Damit wird verhindert, dass beim erneuten Aufrufen der Funktion der Taster nochmals als gedrückt erkannt wird. Die Pinmaske entspricht den angeschlossenen Tasten am Eingang. So wird verhindert, dass alle acht Anschlüssen am Eingang für Tasten reserviert werden.
Anschliessend wird in der Funktion \textit{check\_button()} die Variable \textit{button} auf die vier Optionen Auf-, Abwärtszählen, automatisches Zählen oder Moduswählen geprüft und die entsprechende Aktion ausgeführt.

\subsubsection{Zählen in Einerschritten}
Für das Dekrementieren oder Inkrementieren der Bestrahlungsstärke (\textit{prozent}) wird der Taster (\textit{button}) mit dem Tasterwert (\textit{BUTTONUP} oder \textit{BUTTONDOWN}) verglichen. Bei einem Übereinstimmen wird die Bestrahlungsstärke (\textit{prozent}) de- oder inkrementiert. Eine Prüfung der Variable \textit{prozent} verhindert, dass die Bestrahlungsstärke 20\% unterschreitet oder 100\% überschreitet. Die Schleife des einfachen Zählens setzt auch noch die Verzögerung des automatischen Zählers (\textit{autorepeat}) präventiv auf 50, was ungefähr zwei Sekunden entspricht. Die genau Funktionsweise des automatischen Zählens wird im Kapitel \ref{subsubsec_autocount} beschrieben.

\subsubsection{Automatisches Zählen in Zehnerschritten}\label{subsubsec_autocount}
Nach den Bedingungen für das einfache Zählen folgen die Bedingungen für das automatische Zählen in Zehnerschritten. Die Bedingung für das automatische Aufwärtszählen ist der momentan gedrückte Taster (\textit{current\_button}) UND-Verknüpft mit dem Tasterwert (\textit{BUTTONUP}). Dann wird der automatische Zählerwert ab dem gesetzten Verzögerungswert (\textit{AUTOREPEAT\_SET}) inkrementiert, solange der Taster gedrückt wird. Andernfalls wird unterbrochen und es wird nicht weitergezählt. Falls der Verzögerungs\-wert Null wird, wird die Variable \textit{autorepeat} nochmals auf den Verzögerungswert gesetzt für eine all\-fällige Fortsetzung des automatischen Zählens. Bevor die eigentliche Berechnung erfolgt wird der Taster (\textit{button}) gleich dem Tasterwert (\textit{BUTTONUP} oder \textit{BUTTONDOWN}) gesetzt. Jetzt wird die nächst\-grössere Zehnerzahl berechnet. Dabei wird die Eigenschaft von einem Integervariabeln verwendet, wonach bei beliebigen Operationen immer eine ganze Zahl herauskommt. So wird die Bestrahlungsstärke mit zehn dividiert und mit zehn multipliziert, dabei verliert die Bestrahlungsstärke die Ziffer an der Einerposition. Anschliessend wird zehn addiert und die nächst grössere Zehnerzahl ist berechnet. Auch hier wird am Schluss geprüft, dass beim Aufwärtszählen die Grenze von 100\% nicht überschritten wird.

Das automatische Abwärtszählen ist gleich realisiert bis zum Punkt der Berechnung. Die Berechnung braucht eine Hilfsvariable. Die Differenz zwischen der momentanen Bestrahlungsstärke und der errechneten Zehnerzahl nach der obigen Rechnung wird in die neue Variable gespeichert. Ist die Differenz zehn wird die obige Rechnungsmethode verwendet. Ist jedoch die Differenz grösser als zehn wird bei der Rechnungsmethode auf das Verringern um zehn verzichtet. Das bewirkt, dass z. B. 55\% beim automatisch verringern nicht 40\% ergibt, sondern 50\%. Zuletzt wird wieder geprüft, damit die Bestrahlungsstärke 20\% nicht unterschreitet.

\subsubsection{Modus umschalten}
Entspricht der gedrückte Taster (\textit{button}) dem Tasterwert \textit{MODE} wird die Funktion \textit{modusAendern()} aufgerufen, die bedingt von der Variable  \textit{modus} \textit{MODUSSAUBER} in den Modus \textit{MODUSVERSCHMUTZT} umschaltet und umgekehrt. Beim Umschalten des Modus wurde auf ein automatisches Zählen verzichtet, weil keine grosse Auswahl getroffen werden muss mit dem Taster.

\subsubsection{Bildschirmsoftware}
Der Bildschirm wird beim Starten der Software initialisiert und durch die Funktion \textit{displayAktualisieren()} mit den Startwerten beschrieben. Ist der erste Durchlauf abgeschlossen wird der Bildschirm alle 300ms aktualisiert.

Die erste Zeile ist für die Spannung in Volt reserviert. Sie wird im Format \#\#.\#\# angezeigt. Um die Spannung vom Typ Integer darzustellen wird in der Funktion \textit{printf()} die Spannung (\textit{spannung}) zweimal ausgegeben. Dabei wird zuerst der Integer durch 100 dividiert, um vom Milivolt zu Volt zu gelangen. Anschliessend werden mittels einer Moduloberechnung die Nachkommastellen berechnet. Zudem wird in der Darstellung der Spannung unterschieden, wenn der ADC-Wert grösser als 999 oder kleiner als 1000 ist. Diese Bedingung verhindert, dass der, auf dem Bildschirm, ausgegebene Text horizontal springt.

Die zweite Zeile ist für den Strom in Ampere reserviert. Er wird im Format \#.\#\# angezeigt. Um den Strom vom Typ Integer darzustellen wird die gleiche Berechnung angewendet, wie bei der Spannung. Weil der ADC-Wert nicht über 999 hinausgeht braucht es keine Zusatzbedingung wie bei der Spannung.

Die dritte Zeile ist für die Bestrahlungsstärke in Prozent reserviert. Sie wird im Format \#\#\# angezeigt. Um zu verhindern, dass der Wert \textit{prozent} horizontal springt, gibt die Funktion \textit{displayAktualisieren()} ein String aus ohne Leerschlag, wenn der Wert \textit{prozent} gleich 100 ist.

Die vierte Zeile ist für den Modus reserviert. Durch die Funktion \textit{modusAendern()} ist der Modus (\textit{modus}) entweder gleich \textit{MODUSSAUBER} oder gleich \textit{MODUSVERSCHMUTZT}. Mit der Funktion \textit{displayAktualisieren()} wird durch den gewählten Modus der zugehörige String ausgegeben.